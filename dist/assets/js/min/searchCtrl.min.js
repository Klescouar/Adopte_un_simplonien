app.controller("searchCtrl",["$scope","$http","serviceApi",function(e,t,a){e.schools=a.schools,e.togglePromo=!1,e.toggleLangage=!1,e.toggleContrat=!1,e.searchResult={Langage:[],Ville:"",Contrat:[]},t.get(a.api).then(function(t){e.data=t.data,e.cardFull=t.data},function(e){console.log("C'est la merde!")});var i=function(){e.data=[];var t="undefined"!=typeof e.searchResult.Langage[0]?e.searchResult.Langage[0]:"",a="undefined"!=typeof e.searchResult.Langage[1]?e.searchResult.Langage[1]:"",i="undefined"!=typeof e.searchResult.Langage[2]?e.searchResult.Langage[2]:"",s="undefined"!=typeof e.searchResult.Ville?e.searchResult.Ville:"",n="undefined"!=typeof e.searchResult.Contrat[0]?e.searchResult.Contrat[0]:"",l="undefined"!=typeof e.searchResult.Contrat[1]?e.searchResult.Contrat[1]:"",c="undefined"!=typeof e.searchResult.Contrat[2]?e.searchResult.Contrat[2]:"",o="undefined"!=typeof e.searchResult.Contrat[3]?e.searchResult.Contrat[3]:"",g="undefined"!=typeof e.searchResult.Contrat[4]?e.searchResult.Contrat[4]:"";angular.forEach(e.cardFull,function(r,h){var u=r.contrat+" "+r.specialite1+" "+r.specialite2+" "+r.specialite3+" "+r.ville;u.match("^(?=.*"+t+")(?=.*"+a+")(?=.*"+i+")(?=.*"+s+")(?=.*"+n+")(?=.*"+l+")(?=.*"+c+")(?=.*"+o+")(?=.*"+g+")","i")&&e.data.push(r)})};i(),e.themes=[{name:"Promo",active:!0},{name:"Langage",active:!1},{name:"Contrat",active:!1}],e.langages=[{type:"Javascript",active:!1},{type:"HTML/CSS",active:!1},{type:"PHP",active:!1},{type:"Angular",active:!1},{type:"React",active:!1},{type:"Typescript",active:!1},{type:"Jquery",active:!1},{type:"PHP",active:!1},{type:"Design",active:!1},{type:"JAVA",active:!1},{type:"C#",active:!1},{type:"UI/UX",active:!1},{type:"Ruby",active:!1},{type:"Responsive",active:!1},{type:"Node",active:!1},{type:"Meteor",active:!1},{type:"Git",active:!1}],e.contrats=[{type:"CDD",active:!1},{type:"CDI",active:!1},{type:"Contrat Pro",active:!1},{type:"Stage",active:!1},{type:"Freelance",active:!1}],$(window).width()>640&&$(".filterRight").css("display","block"),$(window).resize(function(){$(window).width()>640&&$(".filterRight").css("display","block")}),$(document).ready(function(){$(function(){var e=$(".filterMain");if(e.length){var t=e.offset().top+4;$(window).scroll(function(){$(window).scrollTop()>t&&screen.width>640?($(".filterMain").addClass("sticktotop"),$(".cardPage").addClass("marginToFix")):($(".filterMain").removeClass("sticktotop"),$(".cardPage").removeClass("marginToFix"))})}})}),e.changeState=function(){"Promo"===this.theme.name?(this.theme.active=!0,e.themes[1].active=!1,e.themes[2].active=!1,$(window).width()<640&&e.togglePromo===!1?($(".filterRight").css("display","block"),e.togglePromo=!0,e.toggleLangage=!1,e.toggleContrat=!1):$(window).width()<640&&e.togglePromo===!0&&($(".filterRight").css("display","none"),e.togglePromo=!1)):"Langage"===this.theme.name?(this.theme.active=!0,e.themes[0].active=!1,e.themes[2].active=!1,$(window).width()<640&&e.toggleLangage===!1?($(".filterRight").css("display","block"),e.togglePromo=!1,e.toggleLangage=!0,e.toggleContrat=!1):$(window).width()<640&&e.toggleLangage===!0&&($(".filterRight").css("display","none"),e.toggleLangage=!1)):"Contrat"===this.theme.name&&(this.theme.active=!0,e.themes[0].active=!1,e.themes[1].active=!1,$(window).width()<640&&e.toggleContrat===!1?($(".filterRight").css("display","block"),e.togglePromo=!1,e.toggleLangage=!1,e.toggleContrat=!0):$(window).width()<640&&e.toggleContrat===!0&&($(".filterRight").css("display","none"),e.toggleContrat=!1))},e.changeFilterSchool=function(){if(this.school.active===!0)this.school.active=!1,e.searchResult.Ville="",i();else if(0===e.searchResult.Ville.length)this.school.active=!0,e.searchResult.Ville=this.school.ville,i();else if(e.searchResult.Ville.length>0)for(var t=0;t<e.schools.length;t++)e.schools[t].active=!1,this.school.active=!0},e.changeFilterLangage=function(){if(e.searchResult.Langage.length<3){if(this.langage.active===!1)this.langage.active=!0,e.searchResult.Langage.push(this.langage.type),i();else if(this.langage.active===!0){this.langage.active=!1;var t=e.searchResult.Langage.indexOf(this.langage.type);t>-1&&e.searchResult.Langage.splice(t,1),i()}}else if(e.searchResult.Langage.length>=3){this.langage.active=!1;var t=e.searchResult.Langage.indexOf(this.langage.type);t>-1&&e.searchResult.Langage.splice(t,1),i()}},e.changeFilterContrat=function(){if(e.searchResult.Contrat.length<5){if(this.contrat.active===!1)this.contrat.active=!0,e.searchResult.Contrat.push(this.contrat.type),i();else if(this.contrat.active===!0){this.contrat.active=!1;var t=e.searchResult.Contrat.indexOf(this.contrat.type);t>-1&&e.searchResult.Contrat.splice(t,1),i()}}else if(e.searchResult.Contrat.length>=5){this.contrat.active=!1;var t=e.searchResult.Contrat.indexOf(this.contrat.type);t>-1&&e.searchResult.Contrat.splice(t,1),i()}},e.deleteSchoolTag=function(){for(var t=0;t<e.schools.length;t++)e.schools[t].ville===e.searchResult.Ville&&(e.schools[t].active=!1);e.searchResult.Ville="",i()},e.deleteLangTag=function(){for(var t=0;t<e.langages.length;t++)if(e.langages[t].type===this.lang){e.langages[t].active=!1;var a=e.searchResult.Langage.indexOf(this.lang);a>-1&&e.searchResult.Langage.splice(a,1)}i()},e.deleteContTag=function(){for(var t=0;t<e.contrats.length;t++)if(e.contrats[t].type===this.cont){e.contrats[t].active=!1;var a=e.searchResult.Contrat.indexOf(this.cont);a>-1&&e.searchResult.Contrat.splice(a,1)}i()}}]);